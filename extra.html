<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced Shop</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
body{background:#f5f5f5;}

/* Product Card */
.product-card{position:relative; overflow:hidden;}
.product-card img{transition:0.4s;}
.product-card:hover img{transform:scale(1.08);}

.wishlist{
position:absolute; top:10px; right:10px;
background:white; width:35px; height:35px;
display:flex; justify-content:center; align-items:center;
border-radius:50%; cursor:pointer;
}
.wishlist.active{color:red;}

.cart-btn{
position:absolute; bottom:-50px; left:50%;
transform:translateX(-50%);
transition:0.4s;
}
.product-card:hover .cart-btn{bottom:20px;}

.cart-popup{
position:fixed; top:20px; right:20px;
background:#198754; color:white;
padding:12px 18px; border-radius:8px;
display:none; z-index:9999;
}

/* Category Bullet Style */
.category-list{
list-style:disc;
padding-left:20px;
}

.category-list li{
cursor:pointer;
margin-bottom:6px;
transition:0.3s;
}

.category-list li:hover{
color:#0d6efd;
}

.active-category{
font-weight:bold;
color:#0d6efd;
}
</style>
</head>
<body>

<div class="container py-5">

<h2 class="text-center mb-4">FakeStore Advanced Shop</h2>

<!-- Search -->
<div class="row mb-3">
<div class="col-md-6">
<input type="text" id="search" class="form-control" placeholder="Search product...">
</div>
</div>

<!-- Categories Bullet -->
<div class="mb-4">
<h5>Categories</h5>
<ul id="category" class="category-list">
<li data-value="all" class="active-category">All</li>
</ul>
</div>

<!-- Products -->
<div class="row g-4" id="product-list"></div>

<!-- Pagination -->
<div class="d-flex justify-content-center mt-4">
<button class="btn btn-outline-dark me-2" onclick="prevPage()">Prev</button>
<button class="btn btn-outline-dark" onclick="nextPage()">Next</button>
</div>

</div>

<!-- Modal -->
<div class="modal fade" id="productModal" tabindex="-1">
<div class="modal-dialog modal-lg">
<div class="modal-content">
<div class="modal-body" id="modalContent"></div>
</div>
</div>
</div>

<div class="cart-popup" id="popup"></div>

<script>
let allProducts = [];
let filteredProducts = [];
let currentPage = 1;
let perPage = 6;

// Load Products
async function loadProducts(){
let res = await fetch('https://fakestoreapi.com/products');
allProducts = await res.json();
filteredProducts = allProducts;
renderProducts();
loadCategories();
}
loadProducts();

// Render Products
function renderProducts(){
let start = (currentPage-1)*perPage;
let end = start + perPage;
let products = filteredProducts.slice(start,end);

let container = document.getElementById("product-list");
container.innerHTML="";

products.forEach(product=>{
container.innerHTML += `
<div class="col-md-4">
<div class="card product-card p-2">

<img src="${product.image}" 
class="card-img-top"
style="height:250px; object-fit:contain; cursor:pointer"
onclick="showDetail(${product.id})">

<div class="wishlist">
<i class="fa-regular fa-heart"></i>
</div>

<button class="btn btn-dark cart-btn"
onclick="addToCart('${product.title.replace(/'/g,"")}')">
Add to Cart
</button>

<div class="card-body text-center">
<h6>${product.title.substring(0,40)}...</h6>
<p class="fw-bold text-primary">$${product.price}</p>
</div>

</div>
</div>`;
});

attachWishlist();
}

// Wishlist
function attachWishlist(){
document.querySelectorAll(".wishlist").forEach(btn=>{
btn.onclick=function(){
this.classList.toggle("active");
let icon=this.querySelector("i");
icon.classList.toggle("fa-solid");
icon.classList.toggle("fa-regular");
}
});
}

// Add to Cart
function addToCart(title){
let cart = JSON.parse(localStorage.getItem("cart")) || [];
cart.push(title);
localStorage.setItem("cart",JSON.stringify(cart));

let popup=document.getElementById("popup");
popup.innerText=`${title} added to cart`;
popup.style.display="block";
setTimeout(()=>popup.style.display="none",2000);
}

// Search
document.getElementById("search").addEventListener("input",function(){
let value=this.value.toLowerCase();
filteredProducts = allProducts.filter(p =>
p.title.toLowerCase().includes(value)
);
currentPage=1;
renderProducts();
});

// Load Categories
function loadCategories() {
let categories = [...new Set(allProducts.map(p => p.category))];
let list = document.getElementById("category");

categories.forEach(cat => {
list.innerHTML += `<li data-value="${cat}">${cat}</li>`;
});

attachCategoryEvents();
}

// Category Click
function attachCategoryEvents(){
document.querySelectorAll("#category li").forEach(item => {
item.addEventListener("click", function(){

document.querySelectorAll("#category li")
.forEach(li => li.classList.remove("active-category"));

this.classList.add("active-category");

let value = this.getAttribute("data-value");

if (value === "all") {
filteredProducts = allProducts;
} else {
filteredProducts = allProducts.filter(p => p.category === value);
}

currentPage = 1;
renderProducts();
});
});
}

// Pagination
function nextPage(){
if(currentPage*perPage < filteredProducts.length){
currentPage++;
renderProducts();
}
}
function prevPage(){
if(currentPage>1){
currentPage--;
renderProducts();
}
}

// Product Detail Modal
function showDetail(id){
let product=allProducts.find(p=>p.id===id);

document.getElementById("modalContent").innerHTML=`
<div class="row">
<div class="col-md-6">
<img src="${product.image}" class="img-fluid">
</div>
<div class="col-md-6">
<h4>${product.title}</h4>
<p>${product.description}</p>
<h5 class="text-primary">$${product.price}</h5>
<button class="btn btn-success"
onclick="addToCart('${product.title.replace(/'/g,"")}')">
Add to Cart
</button>
</div>
</div>
`;

new bootstrap.Modal(document.getElementById('productModal')).show();
}
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
